<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock paper Scissors</title>
</head>
<body>
    <p>Rock paper Scissors</p>

    <button onclick="
        getChoice(0);
    ">Rock</button>

    <button onclick="
        getChoice(1);
    ">Paper</button>

    <button onclick="
        getChoice(2);
    ">Scissors</button>

    <p class="js-winner">Start game</p>
    <p class="js-moves"></p>
    <p class="js-score"> Wins:0, Loses:0, Ties:0</p>

    <button onclick="
        score.wins = 0;
        score.loses = 0;
        score.ties = 0;
        localStorage.removeItem('score');

        updateScreen();
    ">
        Reset Score
    </button>

    

    <script>
        let score = JSON.parse(localStorage.getItem('score')) ||
        {
            wins:0, 
            loses:0,
            ties:0
        };
        updateScreen();

        /*if(!score){
            score = {
                wins:0, 
                loses:0,
                ties:0
            }
        }; */

        function updateScreen(winMessage ='', cpMove = 'Not Moved', userMove = 'Not Moved'){
            const winnerElement = document.querySelector('.js-winner');
            const moveElement = document.querySelector('.js-moves');
            const scoreElement = document.querySelector('.js-score');


            winnerElement.innerHTML = winMessage;
            
            moveElement.innerHTML = `Computer : ${cpMove}, User : ${userMove}`;

            scoreElement.innerHTML = `Wins: ${score.wins}, Loses: ${score.loses}, Ties: ${score.ties}`;

        } 

        function getChoice(userChoice){
         
            const cSelection = Math.random();
            let winMessage = '';
            let compMove = -1
            let cpMove = ''
            let userMove = '';

            if(userChoice === 0){
                userMove = 'Rock';
            }else if(userChoice === 1){
                userMove = 'Paper';
            }else{
                userMove = 'Scissors';
            }
            
            if(cSelection >= 0 && cSelection < 1/3){
                compMove = 0;
                cpMove = 'Rock';
            }
            else if(cSelection >= 1/3 && cSelection < 2/3){
                compMove = 1;
                cpMove = 'Paper';
            }else{
                compMove = 2;
                cpMove = 'Scissors';
            }

            //tie
            if(compMove == userChoice){
                score.ties++;
                winMessage = 'Its a Tie';
            }
            //wins
            if( compMove == 0 && userChoice == 1){
                score.wins++;
                winMessage = 'You won';
            }else if(compMove == 1 && userChoice == 2){
                score.wins++;
                winMessage = 'You won';
            }else if(compMove == 2 && userChoice == 0){
                score.wins++;
                winMessage = 'You won';
            }

            //loses
            if( compMove == 1 && userChoice == 0){
                score.loses++;
                winMessage = 'Computer Won';
            }else if(compMove == 2 && userChoice == 1){
                score.loses++;
                winMessage = 'Computer Won';
            }else if(compMove == 0 && userChoice == 2){
                score.loses++;
                winMessage = 'Computer Won';
            }

            localStorage.setItem('score', JSON.stringify(score));

            
            updateScreen(winMessage, cpMove, userMove);

        }
    </script>
</body>
</html>